<!DOCTYPE html><html><head><meta charset="UTF-8"><title>President v1.6.16</title><script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script><style>*{box-sizing:border-box;margin:0;padding:0}body{font-family:Arial,sans-serif;background:#0d2818;color:white;padding:15px}.version-badge{position:fixed;top:10px;right:10px;background:#1a8c3a;padding:8px 15px;border-radius:20px;font-size:.85em;font-weight:bold;z-index:1000}.audio-controls{position:fixed;top:10px;right:145px;display:flex;align-items:center;gap:12px;z-index:1000;background:rgba(26,140,58,.4);padding:10px 15px;border-radius:25px}.sound-toggle{background:#1a8c3a;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1.5em;transition:all .2s}.sound-toggle:hover{background:#0d5f1f}.sound-toggle.muted{background:#666}.volume-slider{width:100px;height:8px;border-radius:4px;background:rgba(255,255,255,.3);cursor:pointer;-webkit-appearance:none;appearance:none}.game-container{max-width:1600px;margin:0 auto}.header h1{text-align:center;font-size:2.5em}.main-grid{display:grid;grid-template-columns:1fr 320px;gap:20px}.table-section{background:linear-gradient(135deg,#0d5f1f,#1a8c3a);padding:30px;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.5)}.pile-container{background:rgba(0,0,0,.3);border-radius:15px;padding:30px 20px;min-height:200px;position:relative;border:3px dashed rgba(255,255,255,.3)}.pile-info{position:absolute;top:15px;left:20px;color:white;font-size:1em;background:rgba(0,0,0,.7);padding:10px 15px;border-radius:8px;font-weight:bold}.pile-cards{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;gap:15px;min-height:140px;padding-top:20px}.pile-card{width:70px;height:110px;background:linear-gradient(135deg,#fff,#f0f0f0);border:3px solid #333;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:18px;box-shadow:0 6px 15px rgba(0,0,0,.5)}.pile-card.red{color:#d32f2f}.pile-card.black{color:#1a1a1a}.pile-empty{color:#888;font-size:1.2em;font-weight:bold}.hand-section{background:rgba(255,255,255,.05);padding:25px;border-radius:15px;margin-top:20px;border:2px solid rgba(255,255,255,.1)}.hand-display{display:flex;flex-wrap:wrap;gap:12px;margin:15px 0;min-height:150px}.card{width:55px;height:90px;background:linear-gradient(135deg,#fff,#e8e8e8);border:2px solid #222;border-radius:6px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-weight:bold;font-size:16px;transition:all .2s;box-shadow:0 4px 10px rgba(0,0,0,.3)}.card.red{color:#d32f2f}.card.black{color:#1a1a1a}.card:hover{transform:translateY(-8px)}.card.selected{background:linear-gradient(135deg,#1a8c3a,#0d5f1f);color:white !important;transform:translateY(-12px);border-color:#fff}.swap-banner{background:linear-gradient(135deg,#ff9800,#f57c00);padding:20px;border-radius:10px;margin-bottom:20px;text-align:center}.your-turn-banner{background:linear-gradient(135deg,#51cf66,#2f9e44);padding:15px;border-radius:10px;margin-bottom:15px;text-align:center;font-weight:bold;font-size:1.2em}.error-banner{background:linear-gradient(135deg,#ff6b6b,#e03131);padding:15px;border-radius:10px;margin-bottom:15px;text-align:center;font-weight:bold;font-size:1.1em;animation:shake .5s}@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-10px)}75%{transform:translateX(10px)}}button{padding:12px 20px;background:#1a8c3a;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:bold;font-size:1em;transition:all .2s;margin:5px}button:hover:not(:disabled){background:#0d5f1f}button:disabled{background:#555;cursor:not-allowed;opacity:.5}.sidebar{display:flex;flex-direction:column;gap:20px}.card-section{background:rgba(255,255,255,.05);padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,.1)}.setup-section{display:flex;flex-direction:column;gap:20px}.status{padding:12px;border-radius:8px;font-weight:bold;text-align:center;margin-top:12px}.status.connected{background:#d4edda;color:#155724}.status.disconnected{background:#f8d7da;color:#721c24}input,select{padding:10px;border:1px solid #ddd;border-radius:6px;width:100%;margin-bottom:10px}.players-list{display:flex;flex-direction:column;gap:10px}.player-item{padding:12px;background:rgba(255,255,255,.08);border-left:4px solid #666;border-radius:6px;color:white;display:flex;justify-content:space-between;align-items:center}.player-item.current-turn{border-left-color:#ff6b6b;background:rgba(255,107,107,.2);font-weight:bold}.player-item.cpu{border-left-color:#9775fa}.player-item.finished{opacity:.6}.cpu-badge{background:#9775fa;color:white;padding:3px 8px;border-radius:4px;font-size:.75em;margin-left:6px}.role-badge{background:#ff9800;color:white;padding:3px 8px;border-radius:4px;font-size:.75em;margin-left:6px}.finish-badge{background:#51cf66;color:white;padding:3px 8px;border-radius:4px;font-size:.75em;margin-left:6px}#log{background:#1a1a1a;color:#00ff00;padding:12px;border-radius:8px;height:220px;overflow-y:auto;font-family:'Courier New',monospace;font-size:12px;line-height:1.4}</style></head><body><div class="version-badge">v1.6.16</div><div class="audio-controls"><div style="display:flex;align-items:center;gap:8px;"><label style="font-size:.9em;margin:0;">Vol:</label><input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50"></div><div class="sound-toggle" id="soundToggle" onclick="toggleSound()">üîä</div></div><div class="game-container"><div class="header"><h1>üéÆ President</h1><p style="color:#aaa;">v1.6.16 - Live on Fly.io!</p></div><div class="main-grid"><div><div id="yourTurnBanner" style="display:none;" class="your-turn-banner">üîî YOUR TURN!</div><div id="errorBanner" style="display:none;" class="error-banner"></div><div id="swapBanner" style="display:none;" class="swap-banner"><h2 style="margin:0;">üîÑ Card Swapping Phase!</h2><p id="swapInstructions" style="margin:10px 0 0 0;">Select cards to swap</p></div><div class="table-section"><h2>‚ô†Ô∏è Table</h2><div id="currentPlayerDisplay" style="color:#aaa;margin:10px 0;font-size:.9em;"></div><div class="pile-container"><div class="pile-info" id="pileInfo">Waiting...</div><div class="pile-cards" id="pileCards"><div class="pile-empty">Table Clear</div></div></div></div><div class="hand-section"><h3 id="handTitle">üÉè Your Hand</h3><div class="hand-display" id="handDisplay"><p style="color:#888;">Connect to see cards</p></div><div id="gameButtons"><button id="playBtn" onclick="playSelectedCards()" disabled>‚ñ∂Ô∏è Play</button><button onclick="clearSelection()">‚ùå Clear</button><button id="passBtn" onclick="passTurn()" disabled>‚è≠Ô∏è Pass</button></div><div id="swapButtons" style="display:none;"><button id="swapBtn" onclick="submitSwap()" disabled>üîÑ Submit Swap</button><button onclick="clearSelection()">‚ùå Clear</button></div></div></div><div class="sidebar"><div id="setupSection" class="setup-section"><div class="card-section"><h3>üì° Connection</h3><input type="text" id="serverUrl" value="https://president.fly.dev"><button onclick="connectToServer()" style="width:100%">Connect</button><div class="status disconnected" id="connectionStatus">Disconnected</div></div><div class="card-section"><h3>üé≤ Setup</h3><input type="text" id="playerName" value="Player1"><div style="display:flex;gap:10px;margin-bottom:10px;"><label style="color:white;"><input type="checkbox" id="addCPU" checked> CPU</label><select id="numCPU"><option>1</option><option>2</option><option selected>3</option></select></div><button id="createBtn" onclick="createGame()" disabled style="width:100%;margin-bottom:10px">üéÆ Create</button><input id="roomCode" placeholder="Room Code"><button id="joinBtn" onclick="joinGame()" disabled style="width:100%;margin-bottom:10px">üö™ Join</button><button id="startBtn" onclick="startGame()" disabled style="width:100%">‚ñ∂Ô∏è Start</button></div></div><div class="card-section"><h3>üë• Players</h3><div class="players-list" id="playersList"><p style="color:#888;">No players</p></div></div><div class="card-section"><h3>üìú Log</h3><div id="log"></div></div></div></div></div><script>let socket,myId,room,hand=[],sel=new Set(),swapReq=null,lastPhase='waiting';let audioContext=null,processing=false;let soundEnabled=localStorage.getItem('soundEnabled')!=='false';let soundVolume=parseFloat(localStorage.getItem('soundVolume')||'50')/100;function initAudio(){if(audioContext)return;try{audioContext=new(window.AudioContext||window.webkitAudioContext)();}catch(e){}}function playSound(freq=800,duration=.3){if(!soundEnabled||!audioContext)return;try{const osc=audioContext.createOscillator();const gain=audioContext.createGain();osc.connect(gain);gain.connect(audioContext.destination);osc.frequency.value=freq;osc.type='sine';gain.gain.setValueAtTime(soundVolume,audioContext.currentTime);gain.gain.exponentialRampToValueAtTime(.01,audioContext.currentTime+duration);osc.start(audioContext.currentTime);osc.stop(audioContext.currentTime+duration);}catch(e){}}function toggleSound(){soundEnabled=!soundEnabled;localStorage.setItem('soundEnabled',soundEnabled);document.getElementById('soundToggle').textContent=soundEnabled?'üîä':'üîá';document.getElementById('soundToggle').className='sound-toggle'+(soundEnabled?'':' muted');log(soundEnabled?'üîä Sound ON':'üîá Sound OFF');}function updateVolume(val){soundVolume=val/100;localStorage.setItem('soundVolume',val);}function log(m){const d=document.getElementById('log');if(!d)return;d.innerHTML+=`[${new Date().toLocaleTimeString()}] ${m}<br>`;d.scrollTop=d.scrollHeight;}function showError(msg){const banner=document.getElementById('errorBanner');banner.textContent='‚ùå '+msg;banner.style.display='block';playSound(300,.3);setTimeout(()=>banner.style.display='none',3000);}document.getElementById('volumeSlider').addEventListener('input',e=>{updateVolume(e.target.value);playSound(1000,.1);});document.getElementById('volumeSlider').value=soundVolume*100;function connectToServer(){initAudio();if(!socket){socket=io(document.getElementById('serverUrl').value);socket.on('connect',()=>{myId=socket.id;document.getElementById('connectionStatus').className='status connected';document.getElementById('connectionStatus').textContent='‚úÖ Connected';['createBtn','joinBtn','startBtn','playBtn','passBtn'].forEach(id=>document.getElementById(id).disabled=false);log('Connected');playSound(800,.2);});socket.on('disconnect',()=>{document.getElementById('connectionStatus').className='status disconnected';document.getElementById('connectionStatus').textContent='‚ö†Ô∏è Disconnected';log('Disconnected');});socket.on('game-created',d=>{room=d.roomCode;document.getElementById('roomCode').value=d.roomCode;log('Game: '+d.roomCode);playSound(600,.2);});socket.on('game-started',()=>{log('üéÆ Game started');playSound(1000,.3);document.getElementById('setupSection').style.display='none';});socket.on('game-state-update',s=>{if(s.phase!==lastPhase){clearSelection();lastPhase=s.phase;}const pl=document.getElementById('playersList');if(pl&&s.players){pl.innerHTML='';s.players.forEach(p=>{const d=document.createElement('div');d.className='player-item'+(p.id===s.currentPlayerId?' current-turn':'')+(p.isCPU?' cpu':'')+(p.finished?' finished':'');let badges='';if(p.isCPU)badges+='<span class="cpu-badge">CPU</span>';if(p.role)badges+='<span class="role-badge">'+p.role+'</span>';if(p.finished&&p.finishPosition)badges+='<span class="finish-badge">#'+p.finishPosition+'</span>';d.innerHTML='<span>'+p.name+badges+'</span><span>'+p.handSize+'üÉè</span>';pl.appendChild(d);});}document.getElementById('currentPlayerDisplay').textContent='Now: '+s.currentPlayerName+(s.isYourTurn?' (YOU)':'');if(s.isYourTurn){document.getElementById('yourTurnBanner').style.display='block';playSound(1200,.2);}else{document.getElementById('yourTurnBanner').style.display='none';}if(s.phase==='swapping'&&s.swapRequired){swapReq=s.swapRequired;document.getElementById('swapBanner').style.display='block';document.getElementById('swapInstructions').textContent='Select '+swapReq.count+' card'+(swapReq.count>1?'s':'')+' to swap';document.getElementById('gameButtons').style.display='none';document.getElementById('swapButtons').style.display='flex';document.getElementById('handTitle').textContent='üîÑ Select '+swapReq.count+' Cards to Swap';playSound(700,.2);}else{swapReq=null;document.getElementById('swapBanner').style.display='none';document.getElementById('gameButtons').style.display='flex';document.getElementById('swapButtons').style.display='none';document.getElementById('handTitle').textContent='üÉè Your Hand';}const m=s.players.find(p=>p.id===myId);if(m&&m.hand){hand=m.hand;render();}const pileContainer=document.getElementById('pileCards');if(!s.lastPlay||!s.lastPlay.cards||s.lastPlay.cards.length===0){pileContainer.innerHTML='<div class="pile-empty">Table Clear</div>';}else{pileContainer.innerHTML='';s.lastPlay.cards.forEach(card=>{const d=document.createElement('div');d.className='pile-card '+((card.suit==='H'||card.suit==='D')?'red':'black');d.textContent=card.rank+({H:'‚ô•',D:'‚ô¶',C:'‚ô£',S:'‚ô†'}[card.suit]);pileContainer.appendChild(d);});}const canPass=s.lastPlay&&s.lastPlay.type!=='none';document.getElementById('passBtn').disabled=!canPass||!s.isYourTurn;processing=false;});socket.on('play-made',d=>{log('üé¥ '+d.playerName+' played');processing=false;});socket.on('player-passed',d=>{log('‚è≠Ô∏è '+d.playerName);processing=false;});socket.on('error',d=>{log('‚ùå '+d.message);showError(d.message);processing=false;});}}function createGame(){socket.emit('create-game',{playerName:document.getElementById('playerName').value,options:{num_players:4,addCPU:document.getElementById('addCPU').checked,numCPU:parseInt(document.getElementById('numCPU').value)}});}function joinGame(){const c=document.getElementById('roomCode').value.toUpperCase().trim();if(!c||c.length!==6){log('‚ùå Enter 6-char code');return;}room=c;socket.emit('join-game',{roomCode:c,playerName:document.getElementById('playerName').value});log('Joining '+c);}function startGame(){if(socket&&room)socket.emit('start-game',{roomCode:room});}function render(){const h=document.getElementById('handDisplay');if(!h)return;h.innerHTML='';if(!hand||hand.length===0){h.innerHTML='<p style="color:#888;">No cards</p>';return;}hand.forEach((c,i)=>{const d=document.createElement('div');d.className='card '+((c.suit==='H'||c.suit==='D')?'red':'black')+(sel.has(i)?' selected':'');d.textContent=c.rank+({H:'‚ô•',D:'‚ô¶',C:'‚ô£',S:'‚ô†'}[c.suit]);d.onclick=()=>{if(swapReq&&sel.size>=swapReq.count&&!sel.has(i))return;if(sel.has(i))sel.delete(i);else sel.add(i);playSound(600,.1);render();if(swapReq)document.getElementById('swapBtn').disabled=sel.size!==swapReq.count;};h.appendChild(d);});}function clearSelection(){sel.clear();render();}function playSelectedCards(){if(processing||!socket||!room||sel.size===0)return;processing=true;socket.emit('play-cards',{roomCode:room,cardIndices:Array.from(sel).sort((a,b)=>a-b)});sel.clear();}function passTurn(){if(processing||!socket||!room)return;processing=true;socket.emit('pass-turn',{roomCode:room});}function submitSwap(){if(processing||!socket||!room||!swapReq||sel.size!==swapReq.count)return;processing=true;socket.emit('submit-swap',{roomCode:room,cardIndices:Array.from(sel).sort((a,b)=>a-b)});sel.clear();log('Swap submitted');playSound(1000,.2);}window.addEventListener('load',()=>{updateVolume(soundVolume*100);});</script></body></html>